<!DOCTYPE html>
<html>
<head>
    <title>Space Shooter</title>
    <style>
        canvas { border: 1px solid black; background: #000; }
        body { display: flex; justify-content: center; }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <img id="bulletImage" src="bullet.png" style="display:none;">
    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        const bulletImg = document.getElementById("bulletImage");

        // Player
        const player = {
            x: canvas.width / 2,
            y: canvas.height - 50,
            width: 40,
            height: 20,
            speed: 5,
            dx: 0
        };

        // Projectiles
        const projectiles = [];
        const projectileSpeed = -10;

        // Enemies
        const enemies = [];
        const enemySpeed = 2;
        let spawnTimer = 0;

        // Score
        let score = 0;

        // Game controls
        let leftPressed = false;
        let rightPressed = false;
        let spacePressed = false;

        document.addEventListener("keydown", (e) => {
            if (e.key === "ArrowLeft") leftPressed = true;
            if (e.key === "ArrowRight") rightPressed = true;
            if (e.key === " ") spacePressed = true;
        });
        document.addEventListener("keyup", (e) => {
            if (e.key === "ArrowLeft") leftPressed = false;
            if (e.key === "ArrowRight") rightPressed = false;
            if (e.key === " ") spacePressed = false;
        });

        function spawnEnemy() {
            enemies.push({
                x: Math.random() * (canvas.width - 30),
                y: -30,
                width: 30,
                height: 30
            });
        }

        function shoot() {
            projectiles.push({
                x: player.x + player.width / 2 - 2,
                y: player.y,
                width: 4,
                height: 10
            });
        }

        function update() {
            // Player movement
            if (leftPressed && player.x > 0) player.x -= player.speed;
            if (rightPressed && player.x < canvas.width - player.width) player.x += player.speed;

            // Shooting
            if (spacePressed) {
                shoot();
                spacePressed = false; // Prevent continuous shooting
            }

            // Update projectiles
            for (let i = projectiles.length - 1; i >= 0; i--) {
                projectiles[i].y += projectileSpeed;
                if (projectiles[i].y < 0) projectiles.splice(i, 1);
            }

            // Update enemies
            spawnTimer++;
            if (spawnTimer % 60 === 0) spawnEnemy();
            for (let i = enemies.length - 1; i >= 0; i--) {
                enemies[i].y += enemySpeed;
                if (enemies[i].y > canvas.height) enemies.splice(i, 1);
            }

            // Collision detection
            for (let i = enemies.length - 1; i >= 0; i--) {
                for (let j = projectiles.length - 1; j >= 0; j--) {
                    if (projectiles[j].x < enemies[i].x + enemies[i].width &&
                        projectiles[j].x + projectiles[j].width > enemies[i].x &&
                        projectiles[j].y < enemies[i].y + enemies[i].height &&
                        projectiles[j].y + projectiles[j].height > enemies[i].y) {
                        enemies.splice(i, 1);
                        projectiles.splice(j, 1);
                        score += 10;
                        break;
                    }
                }
            }
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw player
            ctx.fillStyle = "white";
            ctx.fillRect(player.x, player.y, player.width, player.height);

           // Old:
           // projectiles.forEach(p => ctx.fillRect(p.x, p.y, p.width, p.height));

           // New:
           projectiles.forEach(p => {
           ctx.drawImage(bulletImg, p.x, p.y, p.width, p.height);
           });

            // Draw enemies
            ctx.fillStyle = "green";
            enemies.forEach(e => ctx.fillRect(e.x, e.y, e.width, e.height));

            // Draw score
            ctx.fillStyle = "white";
            ctx.font = "20px Arial";
            ctx.fillText(`Score: ${score}`, 10, 30);
        }

        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        gameLoop();
    </script>
</body>
</html>
